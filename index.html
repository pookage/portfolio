<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Portfolio Site WIP</title>
		<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
		<script src="https://unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
		<script src="js/components/outline.js"></script>
		<script src="js/components/chunky-link.js"></script>
		<script src="js/components/hit-box.js"></script>
		<script>
			window.addEventListener("DOMContentLoaded", init);

			function init(){
				const scene = document.getElementById("bedroom-scene");
				scene.addEventListener("loaded", initScene);
			}//init
			function initScene(){
				const wallText = document.getElementById("wall-animation-group");
				const foldable = document.getElementById("foldable");
				const camera   = document.getElementById("camera-rig");

				window.addEventListener("keyup", handleKeyPress);

				function handleKeyPress(event){
					switch(event.key){
						case "Escape":
							wallText.emit("show");
							foldable.emit("show");
							camera.emit("blur");
							break;
					}
				}//handleKeyPress
			}//initScene
		</script>
	</head>
	<body>
		<a-scene
			id="bedroom-scene" 
			background="color: black;"
			vr-mode-ui="enabled: false"
			cursor="rayOrigin: mouse"
			raycaster="objects: .clickable">

			
			<a-assets>

				<!-- ASSETS -->	
				<a-asset-item id="bed-model" src="assets/3d/bed/model.obj"></a-asset-item>
				<a-asset-item id="desk-model" src="assets/3d/desk/model.obj"></a-asset-item>
				<a-asset-item id="lighthouse-model" src="assets/3d/lighthouse/model.obj"></a-asset-item>
				<a-asset-item id="plug-model" src="assets/3d/plug/model.obj"></a-asset-item>
				<a-asset-item id="vive-model" src="assets/3d/vive/model.obj"></a-asset-item>
				<a-asset-item id="box-model" src="assets/3d/box/model.obj"></a-asset-item>
				<a-asset-item id="kandinsky-font" src="assets/fonts/kandinsky/kandinsky.json"></a-asset-item>
				<a-asset-item id="consolas-font" src="assets/fonts/consolas/regular.json"></a-asset-item>
				<a-asset-item id="consolas-font-bold" src="assets/fonts/consolas/bold.json"></a-asset-item>

				<!-- MIXINS -->
				<a-mixin 
					id="cel-shade" 
					material="color: #000000; roughness: 0.9;" 
					outline>	
				</a-mixin>
				<a-mixin
					id="text-color"
					material="color: #FFFFFF">
				</a-mixin>

				<!-- ANIMATIONS -->
				<a-mixin
					id="animation__rotate__out"
					animation__rotate__out="property: rotation.x; to: -90; dur: 1000; easing: easeInOutQuart; startEvents: hide;">	
				</a-mixin>
				<a-mixin
					id="animation__rotate__in"
					animation__rotate__in="property: rotation.x; to: 0; dur: 1200; easing: easeInOutQuart; startEvents: show;">		
				</a-mixin>
				<a-mixin
					id="animation__nudge__in"
					animation__nudge__in="property: position.z; to: 0; dur: 100; delay: 100; easing: easeOutElastic; startEvents: show;">
				</a-mixin>
				<a-mixin
					id="animation__nudge__out"
					animation__nudge__out="property: position.z; to: -0.04; dur: 300; delay: 700; easing: easeOutQuart; startEvents: hide;">
				</a-mixin>
				<a-mixin
					id="animation__camera__focus"
					animation__camera__position__focus="property: position; to: 1.1 0.25 -3.2; delay: 150; easing: easeInOutQuart; startEvents: focus;"
					animation__camera__rotation__focus="property: rotation; to: -12.75 40 0; delay: 150; easing: easeInOutQuart; startEvents: focus;">
				</a-mixin>
				<a-mixin
					id="animation__camera__natural"
					animation__camera__position__blur="property: position; to: 0 0 0; dur: 1000; easing: easeInOutQuart; startEvents: blur;"
					animation__camera__rotation__blur="property: rotation; to: -12.75 -19.25 0; dur: 1000; easing: easeInOutQuart; startEvents: blur;">
				</a-mixin>
			</a-assets>


			<!-- ROOM -->
			<a-entity id="room">
				<a-plane
					id="wall"
					color="#111" 
					height="5"
					width="5"
					color="black"
					position="0 2.5 -2.5">

					<a-entity
						id="wall-text"
						position="-2.25 -0.333 0">

						<a-entity 
							id="wall-animation-group"
							mixin="animation__nudge__in animation__nudge__out">

							<!-- TITLE -->
							<a-entity
								id="title"
								position="0 0.5 -0.035">
								<a-entity
									text-geometry="value: POOKAGE; font: #kandinsky-font; size: 0.4; height: 0.04;"
									mixin="text-color">
								</a-entity>
								<a-entity
									text-geometry="value: .dev; font: #consolas-font; size: 0.152; height: 0.04;"
									position="2.5 0 0"
									mixin="text-color">
								</a-entity>
							</a-entity>

							<!-- LINKS -->
							<a-entity 
								id="links"
								position="0 0.2 -0.03">
								<a-entity
									position="0 0 0">
									<a-chunky-link
										text-geometry="value: PORTFOLIO; font: #consolas-font-bold; size: 0.162; height: 0.04;"
										mixin="text-color"
										events="fold"
										target="portfolio">
									</a-chunky-link>
								</a-entity>
								<a-entity
									position="0 -0.19 0">
									<a-chunky-link
										text-geometry="value: ARTICLES; font: #consolas-font-bold; size: 0.162; height: 0.04;"
										mixin="text-color"
										target="articles">
									</a-chunky-link>
								</a-entity>
								<a-entity
									position="0 -0.38 0">
									<a-chunky-link
										text-geometry="value: CONTACT; font: #consolas-font-bold; size: 0.162; height: 0.04;"
										mixin="text-color"
										target="contact">
									</a-chunky-link>
								</a-entity>
							</a-entity>
						</a-entity>
					</a-entity>
				</a-plane>

				<a-entity
					id="foldable"
					position="0 0 -2.5"
					mixin="animation__rotate__in animation__rotate__out">
					<a-entity 
						id="hinge"
						position="0 0 2.5">
						<a-plane
							id="floor"
							color="#111" 
							height="5"
							width="5"
							color="black"
							rotation="-90 0 0"
							material="side: double;">
						</a-plane>
						
						<a-obj-model
							id="bed"
							outline
							position="1.45 0.7 1" 
							rotation="0 90 0"
							mixin="cel-shade"
							src="#bed-model">
						</a-obj-model>
						<a-entity 
							id="desk-group"
							position="-1.75 1.18 -2"
							rotation="0 180 0">
							<a-obj-model
								id="desk"
								src="#desk-model"
								mixin="cel-shade">
							</a-obj-model>
							<a-obj-model
								id="vive"
								src="#vive-model"
								scale="0.30 0.30 0.30"
								position="-0.819 -0.05 0"
								rotation="10 -30 0"
								mixin="cel-shade">
							</a-obj-model>
						</a-entity>
						<a-obj-model
							id="lighthouse"
							src="#lighthouse-model"
							position="2.4 2.085 -2.4"
							rotation="0 180 0"
							mixin="cel-shade">
						</a-obj-model>
						<a-obj-model 
							id="plug-socket"
							src="#plug-model"
							position="2.1 0.325 -2.45"
							rotation="0 180 0"
							mixin="cel-shade">
						</a-obj-model>
						<a-obj-model
							id="cardboard-box"
							position="1.222 0.24 -1.22"
							rotation="0 160 0"
							src="#box-model"
							mixin="cel-shade">
						</a-obj-model>
					</a-entity>
			</a-entity>

			<!-- CAMERA -->
			<a-entity
				id="camera-rig"
				mixin="animation__camera__natural animation__camera__focus"
				rotation="-12.75 -19.25 0" >
				<a-entity
					position="-2.73 1.576 1.927"
					rotation="7 -40 -6.5">
					<a-camera
						fov="60"
						position="0 0 0"
						look-controls="enabled: false; hmdEnabled: false; ">
					</a-camera>
				</a-entity>
			</a-entity>
		</a-scene>
	</body>
</html>